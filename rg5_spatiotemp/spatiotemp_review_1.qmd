---
title: "Assessing the Impact of Outliers on Least Square Variogram Model"
format:
  jasa-pdf:
    keep-tex: true  
    journal:
      blinded: false
  jasa-html: default
linestretch: 1.5
date: 2024-02-28
author:
  - name: Caterina Daidone, Marco Zanotti
    affiliations:
      - name: University of Milano Bicocca
abstract: |
  It is a matter of common experience that ore values often do not follow the 
  normal (or lognormal) distributions assumed for them, but, instead, follow 
  some other heavier-tailed distribution. This study reviews the two most 
  popular methods for the variogram estimation, that is the classical and the 
  robust variograms. Moreover, a simulation study is performed to assess the 
  impact of outliers on the variogram estimates. It is shown that the use of 
  the robust variogram yields stable estimates when the scale of the 
  contamination increases.
keywords:
  - spatial statistics
  - outliers
  - variogram
bibliography: bibliography.bib 
---


## Introduction

an introductory section describing the main task tackled in the paper (along with relevant bibliographic references) 



## Methods

a methodological section covering methods 

<!-- # The empirical semivariogram is created by averaging the squared differences  -->
<!-- # between pairs of points that are approximately the same distance apart.   -->
<!-- # Even a few outliers can heavily influence this average (particularly because  -->
<!-- # you're squaring the difference).  -->
<!-- #  -->
<!-- # Outliers are almost always problematic for kriging, but they're particularly  -->
<!-- # bad when the outliers are scattered randomly throughout the study region  -->
<!-- # (rather than being clustered together).  This is because randomly scattered  -->
<!-- # outliers will affect the empirical semivariances at small distances (because  -->
<!-- # they might be right next to low values), but if the outliers are clustered,  -->
<!-- # the squared difference between two outliers might still be small, allowing for  -->
<!-- # accurate semivariogram estimation at small distances (which is the most  -->
<!-- # important part of the semivariogram because closer neighbors get the highest weights). -->


## Simulation

In order to assess the impact of outliers on the variogram estimation based on 
the classical and the robust approaches, a simulation study is permformed. 
Simulating Gaussian Random Fields (GRF) and Contaminated Gaussian Random Fields 
(CGRF) involves different approaches due to the added complexity of contamination. 
GRFs solely need a mean and covariance function. This function dictates the 
smoothness and spatial dependence of the field. Common methods for generating 
GRF include the spectral method (using Fast Fourier Transforms) and the Cholesky 
decomposition. Simulating CGRF, instead, introduces an additional layer of 
complexity. In this case, the underlying GRF represents the "true" signal, while 
the contamination acts as an independent noise process. Common approaches involve 
generating the GRF first, then adding a separate noise field with its own 
properties (e.g., mean, variance, spatial dependence). Alternatively, one can 
directly simulate the CGRF by incorporating the contamination into the covariance 
function itself.

Following @cre:1980, the departure from Gaussianity is obtained simulating a GRF 
with probability $1 - \epsilon$ and a CGRF with probability $\epsilon$.  
$$
\begin{cases}
  N(0, \sigma^2), \;\;\;\;\;\;\; with \; probability \; 1-\epsilon \\
  N(0, k^2 \sigma^2), \;\;\;\; with \; probability \; \epsilon
\end{cases}
$$

where $\epsilon$ is the probability of contamination and $k$ measures the scale 
of the contamination. To practically simulate the underlying GRF, the grf 
function of the geoR package in R is used.  

The simulation is based on 1000 spatial points on a regular grid, with a mean 
of 0 and a covariance function with parameters $\sigma^2 = 1$ and $\phi = 0.25$. 
The base scenario, that is no contamination, is simulated with $\epsilon = 0$.  

![](img/grf.png){fig-align="center" width="300"}

Then six different contaminated scenarios are simulated based on the combinations 
of $epsilon = (0.05, 0.1, 0.2)$ and $kappa = (5, 10)$, to assess the impact of
contamination on the variogram estimation under different circumstances.  

![](img/cgrf.png){fig-align="center" width="500"}

Nugget and different levels of spatial correlation are not considered in this 
simulation study but they can be easily added to the simulation process.  



## Results

The variogram estimation is performed using the classical (in black) and the 
robust (in red) approaches. The two methods are compared on the different 
simulated scenarios to assess their robustness to contamination. Moreover, 
given that outliers are almost always problematic for kriging, a variogram model 
is also estimated, using the OLS estimator, to see how the outliers affect the 
model estimates. The estimation process is performed using the functions variog 
and variofit of the geoR package in R.     

The base scenario, that is no contamination, shows that the two methods provide 
almost identical results.  

![](img/variog_grf_ols.png){fig-align="center" width="500"}  

In the presence of contamination, instead, the two methods provide different
results. If the results are analyzed in terms of the outliers' scale ($kappa$), 
it is possible to observe two different behaviours. For small outliers' scale, 
that is $kappa = 5$, the two methods provide similar estimations independently 
of the number of outliers ($\epsilon$). However, for large outliers' scale, 
that is $kappa = 10$, the estimates are more different the higher the number of 
outliers.  

![](img/variog_cgrf_ols.png){fig-align="center" width="600"}  

As expected, from theoretical considerations, the robust variogram estimates are 
generally smaller than the classical ones. Indeed, the classical approach is 
heavily influenced primarily by the scale of the outliers, while the robust 
approach is less sensitive to the contamination. Moreover, the scale of the 
contamination also strongly affects the estimation of the nugget (which should 
be always 0), but the robust approach is much less sensitive to this issue.  

![](img/variog_est_ols.png){fig-align="center" width="500"}  



## Conclusion

The theoretical considerations suggest that the robust variogram is less 
sensitive to the presence of outliers. For this reason it should be preferred 
when the data are contaminated. The simulation study confirms this results and 
shows that the robust variogram yields stable estimates when the scale of the
contamination increases. However, if the scale of the contamination is small, 
then the two methods provide similar results.  

